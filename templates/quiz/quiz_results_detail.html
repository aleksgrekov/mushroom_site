{% extends 'base.html' %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="text-center mb-5">
            <h1 class="display-4 mb-3">üìä –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</h1>
            <p class="lead">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–≤–∏–∑–∞ –¥–ª—è <strong>{{ quiz_result.user_name }}</strong></p>
        </div>

        <!-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="card shadow-lg mb-4">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0">üìà –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h4>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-md-3">
                        <div class="display-6 text-primary">{{ quiz_result.percentage }}%</div>
                        <small class="text-muted">–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</small>
                    </div>
                    <div class="col-md-3">
                        <div class="display-6 text-success">{{ quiz_result.correct_answers }}/{{ quiz_result.total_questions }}</div>
                        <small class="text-muted">–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã</small>
                    </div>
                    <div class="col-md-3">
                        <div class="display-6 text-danger">{{ quiz_result.wrong_answers }}</div>
                        <small class="text-muted">–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã</small>
                    </div>
                    <div class="col-md-3">
                        <div class="display-6 text-warning">{{ quiz_result.score }}</div>
                        <small class="text-muted">–ë–∞–ª–ª–æ–≤</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º -->
        <div class="card shadow-lg">
            <div class="card-header bg-info text-white">
                <h4 class="mb-0">üìù –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã</h4>
            </div>
            <div class="card-body">
                {% for user_answer in detailed_results %}
                <div class="question-result mb-4 p-3 border rounded {% if user_answer.is_correct %}border-success bg-light{% else %}border-danger bg-light{% endif %}">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <h5 class="mb-0">–í–æ–ø—Ä–æ—Å {{ forloop.counter }}</h5>
                        <span class="badge {% if user_answer.is_correct %}bg-success{% else %}bg-danger{% endif %}">
                            {% if user_answer.is_correct %}‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ{% else %}‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ{% endif %}
                        </span>
                    </div>
                    
                    <p class="fw-bold mb-3">{{ user_answer.question.question_text }}</p>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h6>–í–∞—à –æ—Ç–≤–µ—Ç:</h6>
                            <div class="mb-2">
                                {% for answer in user_answer.selected_answers.all %}
                                <span class="badge bg-secondary me-1 mb-1">{{ answer.answer_text }}</span>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:</h6>
                            <div class="mb-2">
                                {% for answer in user_answer.get_correct_answers %}
                                <span class="badge bg-success me-1 mb-1">{{ answer.answer_text }}</span>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    
                    {% if not user_answer.is_correct %}
                    <div class="alert alert-warning mt-2 mb-0">
                        <small>
                            <strong>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:</strong> 
                            –í—ã –≤—ã–±—Ä–∞–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç–º–µ—á–µ–Ω –∑–µ–ª–µ–Ω—ã–º —Ü–≤–µ—Ç–æ–º.
                        </small>
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <div class="text-center mt-4">
            <a href="{% url 'quiz_home' %}" class="btn btn-primary">
                üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é –∫–≤–∏–∑–æ–≤
            </a>
            <a href="{% url 'quiz_start' quiz_result.quiz.id %}" class="btn btn-outline-primary">
                üîÑ –ü—Ä–æ–π—Ç–∏ –∫–≤–∏–∑ —Å–Ω–æ–≤–∞
            </a>
        </div>
    </div>
</div>

<style>
.question-result {
    transition: all 0.3s ease;
}
.question-result:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}
</style>
{% endblock %}